<div class="container mt-5">
  <div class="row mb-4">
    <div class="col">
      <h1 class="mb-2">Dashboard</h1>
      <p class="text-muted mb-0">Track your favorites, preferences, and meal planning shortcuts.</p>
    </div>
  </div>

  {{#if message}}
  <div class="alert alert-{{#if error}}danger{{else}}info{{/if}}">
    {{message}}
  </div>
  {{/if}}

  <div class="row g-4">
    <div class="col-md-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <h6 class="text-uppercase text-muted">Saved Recipes</h6>
          <h2 class="display-6">{{favoriteCount}}</h2>
          <p class="text-muted">Ready-to-cook meals in your personal collection.</p>
          <a href="/favorites" class="btn btn-outline-primary btn-sm">Manage Favorites</a>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card h-100 shadow-sm">
        <div class="card-header">
          Recently Favorited Recipes
        </div>
        <div class="card-body">
          {{#if recentFavorites.length}}
          <div class="list-group list-group-flush">
            {{#each recentFavorites}}
            <div class="list-group-item">
              <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
                <div>
                  <h6 class="mb-1">{{title}}</h6>
                  <small class="text-muted">Saved {{formatDate favoritedAt}}</small>
                </div>
                <div class="text-end">
                  {{#if totalCostPerServing}}
                  <span class="badge bg-success-subtle text-success-emphasis border border-success-subtle">
                    {{formatCurrency totalCostPerServing}} / serving
                  </span>
                  {{/if}}
                  {{#if readyInMinutes}}
                  <span class="badge bg-info-subtle text-info-emphasis border border-info-subtle">
                    {{readyInMinutes}} min
                  </span>
                  {{/if}}
                </div>
              </div>
              {{#if summary}}
              <p class="small text-muted mb-0 mt-2">{{summary}}</p>
              {{/if}}
            </div>
            {{/each}}
          </div>
          {{else}}
          <p class="text-muted mb-0">Save recipes to see your personalized recommendations here.</p>
          {{/if}}
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4 mt-1">
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-header">
          Meal Sorting Preferences
        </div>
        <div class="card-body">
          {{#if preferences}}
          <p class="mb-1"><strong>Sort by:</strong> {{preferences.sort_by}} ({{preferences.sort_order}})</p>
          <p class="mb-3 text-muted small">Priority weights:</p>
          <ul class="list-unstyled small mb-0">
            <li>Price: {{preferences.priority_factors.price}}</li>
            <li>Time: {{preferences.priority_factors.time}}</li>
            <li>Calories: {{preferences.priority_factors.calories}}</li>
            <li>Health: {{preferences.priority_factors.health}}</li>
          </ul>
          {{else}}
          <p class="text-muted mb-0">Using default recommendations. Update them under <a href="/settings">Settings</a>.</p>
          {{/if}}
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card h-100 shadow-sm">
        <div class="card-header">
          Quick Actions
        </div>
        <div class="card-body d-grid gap-2">
          <a href="/discover" class="btn btn-primary">Discover Recipes</a>
          <a href="/favorites" class="btn btn-outline-primary">Plan from Favorites</a>
          <a href="/settings" class="btn btn-outline-secondary">Adjust Preferences</a>
        </div>
      </div>
    </div>
  </div>
</div>
